# **產品需求文件 (PRD): 平台數據匯出 PDF 功能**

| 文件資訊 |  |
| :---- | :---- |
| **文件標題** | PRD \- 平台數據匯出 PDF 功能 |
| **產品/專案** | 水資源查詢與估算平台 |
| **文件作者** | \[您的名字/團隊\] |
| **建立日期** | 2025-10-27 |
| **文件版本** | 1.0 |

## **1\. 功能概述 (Feature Overview)**

本文件旨在定義「水資源查詢與估算平台」的新功能：**匯出 PDF 報告**。

目前平台能即時運算並在網頁上顯示用水量、用電量等多維度數據與圖表。為提升平台的實用性與資料可攜性，我們需要提供一個功能，讓使用者能將當前畫面的核心數據（包含輸入參數、統計摘要、趨勢圖表）匯出為一份結構化的 PDF 文件，以便於線下查閱、歸檔、列印或與他人分享。

## **2\. 解決的問題 (The Problem)**

* **資料無法離線保存：** 使用者離開網頁後，查詢與估算的結果即消失，無法方便地進行後續追蹤或歸檔。  
* **分享不便：** 使用者難以將複雜的圖表與數據摘要，用一個簡單、標準化的格式分享給其他人（例如管理人員、同事或顧問）。  
* **缺乏正式報告：** 使用者需要手動截圖或複製貼上資料，才能製作一份非正式的報告，過程繁瑣且不專業。

## **3\. 使用者故事 (User Stories)**

* **身為一位農場管理者：** 我希望能將本季的用水估算結果（包含作物類型、耕地面積、用水趨勢圖）匯出成一份 PDF，以便在月底的管理會議上提出，並作為下季灌溉策略的參考文件。  
* **身為一位水資源顧問：** 我希望能將不同參數（如不同馬力、不同井深）的估算結果分別匯出成多份 PDF，以便在報告中附上這些估算情境，向我的客戶說明最佳方案。

## **4\. 功能需求 (Functional Requirements)**

### **4.1 觸發點 (Trigger)**

* 在平台的「歷史記錄」區塊，現有的「匯出CSV」、「匯出JSON」按鈕旁，應新增一個按鈕。  
* **按鈕文字：** 匯出 PDF  
* **按鈕圖示：** （建議使用常見的 PDF 或下載圖示）

### **4.2 匯出內容 (Export Content)**

匯出的 PDF 應包含以下區塊，版面配置應參考使用者提供的 PDF 範例：

**頁首 (Header)**

* **報告標題：** 「水資源查詢與估算平台 \- 數據報告」  
* **匯出時間：** （動態產生，例如：2025年10月27日 13:30）

**區塊一：輸入參數 (Input Parameters)**

* 此區塊應條列式顯示使用者**當前**在平台輸入的所有參數值。  
* 電費金額: \[數值\] 元  
* 計費期間: \[日期區間\]  
* 電價種類: \[文字\]  
* 作物類型: \[文字\]  
* 耕地面積: \[數值\] m² (或公頃)  
* 抽水馬力: \[數值\] HP  
* 抽水效率: \[數值\] %  
* 水井深度: \[數值\] m

**區塊二：統計摘要 (Statistical Summary)**

* 此區塊應顯示如範例 PDF P.1 的摘要卡片。  
* 總抽水次數: \[數值\]  
* 平均月用水量: \[數值\] m³  
* 總用電度數: \[數值\] kWh

**區塊三：圖表視覺化 (Charts & Visualization)**

* 所有圖表應以高解析度圖片 (高保真) 的形式嵌入 PDF。  
* 圖表標題應清晰可見。  
* **圖表 3.1：季節性用水趨勢**  
  * 內容：如範例 PDF P.1 所示的線圖 (用水量 vs. 季節)。  
* **圖表 3.2：作物用水量比較**  
  * 內容：如範例 PDF P.2 所示的長條圖。  
* **圖表 3.3：年度用水趨勢**  
  * 內容：如範例 PDF P.2 所示的雙軸圖 (用水量 m³ vs. 用電 kWh)。

**區塊四：數據洞察 (Data Insights)**

* 此區塊應顯示如範例 PDF P.2 的洞察摘要。  
* 總紀錄次數: \[數值\]  
* 平均用水量: \[數值\] m³  
* 最大用水量: \[數值\] m³  
* 最小用水量: \[數值\] m³  
* 平均用電: \[數值\] kWh  
* **洞察文字：**  
  * \[動態產生的文字，例如：所有均在建議用水量內\]  
  * \[動態產生的文字，例如：用水量變化範圍...\]  
  * \[動態產生的文字，例如：建議定期檢視...\]

**頁尾 (Footer)**

* 頁碼 (例如：第 1 頁 / 共 2 頁)

### **4.3 檔案規格 (File Specifications)**

* **檔案格式：** PDF (Portable Document Format)  
* **檔案命名：** 水資源估算報告\_{YYYYMMDD}.pdf (例如：水資源估算報告\_20251027.pdf)  
* **紙張大小：** A4  
* **方向：** 縱向 (Portrait / 直向)

## **5\. 非功能需求 (Non-Functional Requirements)**

| 類別 | 需求 |
| :---- | :---- |
| **技術實作** | **\[重要\]** 應優先採用**瀏覽器端 (Client-Side)** 解決方案 (例如 jsPDF \+ html2canvas 函式庫)，以避免增加伺服器負擔，並符合目前單一 HTML 檔案的應用架構。 |
| **效能** | 使用者點擊「匯出 PDF」按鈕後，應在 5 秒內觸發瀏覽器下載（不含使用者儲存檔案的思考時間）。 |
| **視覺保真** | 匯出的 PDF 內容應「所見即所得」(WYSIWYG)，圖表與網頁上顯示的應一致，不可出現破圖或渲染不全 (例如圖表還在 loading 狀態) 的情況。 |
| **易用性** | 匯出功能應一步到位，使用者點擊按鈕後即應觸發下載，不應有過多額外的設定步驟。 |
| **限制** | (需釐清) 若採用 html2canvas 方案，PDF 內容將由圖片組成，**PDF 內的文字將無法被選取或搜尋**。此技術取捨需在開發前確認是否可接受。 |

## **6\. 驗收標準 (Acceptance Criteria)**

* **Given:** 使用者在「水資源查詢與估算平台」上已輸入所有參數，且畫面上已產生完整的統計摘要、圖表與數據洞察。  
* **When:** 使用者點擊「匯出 PDF」按鈕。  
* **Then:** 瀏覽器應自動下載一份 PDF 檔案，檔案名稱應符合 水資源估算報告\_{日期}.pdf 格式。  
* **And:** 使用者在標準 PDF 閱讀器（如瀏覽器內建、Adobe Reader）中開啟該檔案。  
* **And:** 檔案應為 A4 直向，且包含 PRD 4.2 中定義的所有區塊（輸入參數、摘要、圖表、洞察）。  
* **And:** 所有圖表均清晰可見，數據與網頁上顯示的完全一致。  
* **And:** 若報告內容超過一頁，應有正確的分頁與頁碼。